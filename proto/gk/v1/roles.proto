syntax = "proto3";

package gk.v1;

import "gk/v1/common.proto";
import "gk/v1/permissions.proto";
import "google/api/annotations.proto";

service Roles {
	rpc AddPermission(RolesAddPermissionRequest) returns (Role) {
		option (google.api.http) = {
			put : "/v1/roles/{role_id}/permissions/{permission_id}"
			body : "*"
		};
	}

	rpc Create(RolesCreateRequest) returns (Role) {
		option (google.api.http) = {
			post : "/v1/roles"
			body : "*"
		};
	}

	rpc List(RolesListRequest) returns (RolesListResponse) {
		option (google.api.http) = {
			get : "/v1/roles?_limit={page.limit}&_offset={page.offset}"
		};
	}

	rpc Retrieve(RolesRetrieveRequest) returns (Role) {
		option (google.api.http) = {
			get : "/v1/roles/{id}"
		};
	}

	rpc Update(RolesUpdateRequest) returns (Role) {
		option (google.api.http) = {
			patch : "/v1/roles/{id}"
			body : "*"
		};
	}
}

message Role {
	string id   = 1;
	string name = 2;

	repeated Permission permissions = 3;
}

message RolesAddPermissionRequest {
	string role_id       = 1;
	string permission_id = 2;
}

message RolesCreateRequest {
	optional string id   = 1;
	string          name = 2;

	repeated string permission_ids = 3;
}

message RolesListRequest {
	optional Page page = 1;
}

message RolesListResponse {
	repeated Role data = 1;
	Meta          meta = 2;
}

message RolesRetrieveRequest {
	string id = 1;
}

message RolesUpdateRequest {
	string id   = 1;
	string name = 2;
}
